<div class="task-form-container">
  @if (!isAuthenticated) {
    <div class="welcome-card modern-card">
      <div class="welcome-content">
        <div class="welcome-icon">
          <i class="pi pi-lock"></i>
        </div>
        <h2 class="heading-primary">Task Form</h2>
        <p class="text-muted welcome-description">Please log in to create or edit tasks.</p>
        <div class="welcome-actions">
          <p-button 
            label="Login" 
            icon="pi pi-sign-in" 
            (click)="navigateToLogin()"
            class="welcome-btn-primary" />
          <p-button 
            label="Register" 
            icon="pi pi-user-plus" 
            (click)="navigateToRegister()" 
            severity="secondary"
            [outlined]="true"
            class="welcome-btn-secondary" />
        </div>
      </div>
    </div>
  } @else {
    <div class="task-form-card modern-card">
      <div class="form-header">
        <div class="form-icon">
          <i class="pi" [ngClass]="isEditMode ? 'pi-pencil' : 'pi-plus'"></i>
        </div>
        <h1 class="heading-secondary">{{ isEditMode ? 'Edit Task' : 'Create Task' }}</h1>
        <p class="text-muted">{{ isEditMode ? 'Update your task details' : 'Fill in the information below to create a new task' }}</p>
      </div>
      
      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()" class="task-form">
        <div class="form-group">
          <label for="title" class="form-label">Title *</label>
          <input 
            pInputText
            type="text" 
            id="title" 
            formControlName="title" 
            class="form-input"
            [class.error]="taskForm.get('title')?.invalid && taskForm.get('title')?.touched">
          @if (taskForm.get('title')?.invalid && taskForm.get('title')?.touched) {
            <small class="error-message">
              Title is required
            </small>
          }
        </div>
        
        <div class="form-group">
          <label for="description" class="form-label">Description</label>
          <textarea 
            pTextarea
            id="description" 
            formControlName="description" 
            class="form-input"
            rows="4"
            placeholder="Describe your task..."></textarea>
        </div>
        
        <div class="form-group">
          <label for="status" class="form-label">Status</label>
          <p-select 
            [options]="statusOptions" 
            formControlName="status" 
            optionLabel="label" 
            optionValue="value"
            class="form-input"
            placeholder="Select status">
          </p-select>
        </div>

        <div class="form-group">
          <label for="tags" class="form-label">Tags</label>
          <p-multiSelect 
            [options]="tags" 
            [(ngModel)]="selectedTags"
            optionLabel="name" 
            optionValue="id"
            placeholder="Select tags"
            class="form-input"
            [showToggleAll]="false"
            [filter]="true"
            filterBy="name"
            [ngModelOptions]="{standalone: true}">
            <ng-template let-tag pTemplate="selectedItem">
              <div class="selected-tag">
                <span class="tag-color" [style.background-color]="tag.color"></span>
                <span>{{ tag.name }}</span>
              </div>
            </ng-template>
            <ng-template let-tag pTemplate="item">
              <div class="tag-option">
                <span class="tag-color" [style.background-color]="tag.color"></span>
                <span>{{ tag.name }}</span>
              </div>
            </ng-template>
          </p-multiSelect>
          <small class="form-hint">Select tags to organize your task</small>
        </div>
        
        <div class="form-actions">
          <p-button 
            type="button" 
            label="Cancel" 
            icon="pi pi-times"
            (click)="cancel()"
            severity="secondary"
            [outlined]="true"
            class="cancel-btn">
          </p-button>
          <p-button 
            type="submit" 
            [label]="isEditMode ? 'Update Task' : 'Create Task'"
            [icon]="isEditMode ? 'pi pi-save' : 'pi pi-plus'"
            [disabled]="taskForm.invalid"
            class="submit-btn">
          </p-button>
        </div>
      </form>
    </div>
  }
</div>
